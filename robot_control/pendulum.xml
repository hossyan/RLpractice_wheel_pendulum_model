<mujoco model="inverted_pendulum_with_mesh">
    <include file="./shared.xml"></include>
    <compiler assetdir="../stl"/>  
    <option timestep="0.001" gravity="0 0 -9.81"/>

    <asset>
        <mesh name="body" file="body.stl"/>
        <mesh name="wheel" file="wheel.stl"/>
    </asset>

    <worldbody>
        <!-- 本体(モータ付き) -->
        <body name="base" pos="0 0 0.012">
            <joint type="free"/>
            <inertial mass="0.225224" pos="-1.104e-5 1.555e-5 0.037196" diaginertia="2.050e-4 3.366e-4 2.105e-4"/>
            <geom type="mesh" mesh="body" rgba="0.6 0.6 0.6 1" pos="0 0 0" contype="1" conaffinity="1"/> 
            <site name="imu_site" pos="0 0 0.07"/>
        
        <!-- タイヤ左 -->
            <body name="wheel_L" pos="-0.047 0 0.0196">
            <joint name="hinge_L" type="hinge" axis="1 0 0" pos="0 0 0" damping="0.0001"/>
            <inertial mass="0.021477" pos="0.464e-3 0 0" diaginertia="1.2039e-5 6.234e-6 6.233e-6"/>
            <geom type="mesh" mesh="wheel" solref="0.02 1.0" solimp="0.9 0.95 0.001" rgba="0.8 0.8 0.85 1" pos="0 0 0" contype="1" conaffinity="1"/>
            </body>


        <!-- タイヤ右 -->
            <body name="wheel_R" pos="0.047 0 0.0196" euler="0 0 180">
            <joint name="hinge_R" type="hinge" axis="1 0 0" pos="0 0 0" damping="0.0001"/>
            <inertial mass="0.021477" pos="-0.464e-3 0 0" diaginertia="1.2039e-5 6.234e-6 6.233e-6"/>
            <geom type="mesh" mesh="wheel" solref="0.02 1.0" solimp="0.9 0.95 0.001" rgba="0.8 0.8 0.85 1" pos="0 0 0" contype="1" conaffinity="1" />
            </body>
        </body>
        
        <!-- 照明 -->
        <light name="light1" pos="0 0 3" dir="0 0 -1" directional="true" castshadow="false" />
    </worldbody>

    <!-- 衝突判定 -->
    <contact>
        <exclude body1="base" body2="wheel_L"/>
        <exclude body1="base" body2="wheel_R"/>
    </contact>
    
    <!-- モータ -->
    <actuator>
        <general name="wheel_hinge_left" joint="hinge_L" ctrlrange="-0.021 0.021" gear="1" ctrllimited="true" dyntype="filter" dynprm="0.005"/>
        <general name="wheel_hinge_right" joint="hinge_R" ctrlrange="-0.021 0.021" gear="1" ctrllimited="true" dyntype="filter" dynprm="0.005"/>
    </actuator> 

    <!-- センサー -->
    <sensor>
        <accelerometer name="body_accel" site="imu_site" noise="0.01"/>
        <gyro name="body_gyro" site="imu_site" noise="0.01"/>
    </sensor>
</mujoco>